(function(c,q){var m="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==";c.fn.imagesLoaded=function(f){function n(){var b=c(j),a=c(h);d&&(h.length?d.reject(e,b,a):d.resolve(e));c.isFunction(f)&&f.call(g,e,b,a)}function p(b){k(b.target,"error"===b.type)}function k(b,a){b.src===m||-1!==c.inArray(b,l)||(l.push(b),a?h.push(b):j.push(b),c.data(b,"imagesLoaded",{isBroken:a,src:b.src}),r&&d.notifyWith(c(b),[a,e,c(j),c(h)]),e.length===l.length&&(setTimeout(n),e.unbind(".imagesLoaded",p)))}var g=this,d=c.isFunction(c.Deferred)?c.Deferred():0,r=c.isFunction(d.notify),e=g.find("img").add(g.filter("img")),l=[],j=[],h=[];c.isPlainObject(f)&&c.each(f,function(b,a){if("callback"===b)f=a;else if(d)d[b](a)});e.length?e.bind("load.imagesLoaded error.imagesLoaded",p).each(function(b,a){var d=a.src,e=c.data(a,"imagesLoaded");if(e&&e.src===d)k(a,e.isBroken);else if(a.complete&&a.naturalWidth!==q)k(a,0===a.naturalWidth||0===a.naturalHeight);else if(a.readyState||a.complete)a.src=m,a.src=d}):n();return d?d.promise(g):g}})(jQuery);;(function($){var types=['DOMMouseScroll','mousewheel'];if($.event.fixHooks){for(var i=types.length;i;){$.event.fixHooks[types[--i]]=$.event.mouseHooks;}}
$.event.special.mousewheel={setup:function(){if(this.addEventListener){for(var i=types.length;i;){this.addEventListener(types[--i],handler,false);}}else{this.onmousewheel=handler;}},teardown:function(){if(this.removeEventListener){for(var i=types.length;i;){this.removeEventListener(types[--i],handler,false);}}else{this.onmousewheel=null;}}};$.fn.extend({mousewheel:function(fn){return fn?this.bind("mousewheel",fn):this.trigger("mousewheel");},unmousewheel:function(fn){return this.unbind("mousewheel",fn);}});function handler(event){var orgEvent=event||window.event,args=[].slice.call(arguments,1),delta=0,returnValue=true,deltaX=0,deltaY=0;event=$.event.fix(orgEvent);event.type="mousewheel";if(orgEvent.wheelDelta){delta=orgEvent.wheelDelta/120;}
if(orgEvent.detail){delta=-orgEvent.detail/3;}
deltaY=delta;if(orgEvent.axis!==undefined&&orgEvent.axis===orgEvent.HORIZONTAL_AXIS){deltaY=0;deltaX=-1*delta;}
if(orgEvent.wheelDeltaY!==undefined){deltaY=orgEvent.wheelDeltaY/120;}
if(orgEvent.wheelDeltaX!==undefined){deltaX=-1*orgEvent.wheelDeltaX/120;}
args.unshift(event,delta,deltaX,deltaY);return($.event.dispatch||$.event.handle).apply(this,args);}})(jQuery);;(function($,window,undefined){$.fn.jScrollPane=function(settings)
{function JScrollPane(elem,s)
{var settings,jsp=this,pane,paneWidth,paneHeight,container,contentWidth,contentHeight,percentInViewH,percentInViewV,isScrollableV,isScrollableH,verticalDrag,dragMaxY,verticalDragPosition,horizontalDrag,dragMaxX,horizontalDragPosition,verticalBar,verticalTrack,scrollbarWidth,verticalTrackHeight,verticalDragHeight,arrowUp,arrowDown,horizontalBar,horizontalTrack,horizontalTrackWidth,horizontalDragWidth,arrowLeft,arrowRight,reinitialiseInterval,originalPadding,originalPaddingTotalWidth,previousContentWidth,wasAtTop=true,wasAtLeft=true,wasAtBottom=false,wasAtRight=false,originalElement=elem.clone(false,false).empty(),mwEvent=$.fn.mwheelIntent?'mwheelIntent.jsp':'mousewheel.jsp';originalPadding=elem.css('paddingTop')+' '+
elem.css('paddingRight')+' '+
elem.css('paddingBottom')+' '+
elem.css('paddingLeft');originalPaddingTotalWidth=(parseInt(elem.css('paddingLeft'),10)||0)+
(parseInt(elem.css('paddingRight'),10)||0);function initialise(s)
{var isMaintainingPositon,lastContentX,lastContentY,hasContainingSpaceChanged,originalScrollTop,originalScrollLeft,maintainAtBottom=false,maintainAtRight=false;settings=s;if(pane===undefined){originalScrollTop=elem.scrollTop();originalScrollLeft=elem.scrollLeft();elem.css({overflow:'hidden',padding:0});paneWidth=elem.innerWidth()+ originalPaddingTotalWidth;paneHeight=elem.innerHeight();settings.paneHeight=elem.innerHeight();elem.width(paneWidth);pane=$('<div class="jspPane" />').css('padding',originalPadding).append(elem.children());container=$('<div class="jspContainer" />').css({'width':paneWidth+'px','height':paneHeight+'px'}).append(pane).appendTo(elem);}else{elem.css('width','');maintainAtBottom=settings.stickToBottom&&isCloseToBottom();maintainAtRight=settings.stickToRight&&isCloseToRight();hasContainingSpaceChanged=elem.innerWidth()+ originalPaddingTotalWidth!=paneWidth||elem.outerHeight()!=paneHeight;if(hasContainingSpaceChanged){paneWidth=elem.innerWidth()+ originalPaddingTotalWidth;paneHeight=elem.innerHeight();container.css({width:paneWidth+'px',height:paneHeight+'px'});}
if(!hasContainingSpaceChanged&&previousContentWidth==contentWidth&&pane.outerHeight()==contentHeight){elem.width(paneWidth);return;}
previousContentWidth=contentWidth;pane.css('width','');elem.width(paneWidth);container.find('>.jspVerticalBar,>.jspHorizontalBar').remove().end();if($('.jspPane').innerHeight()<300){$('.jspContainer').height($('.jspPane').innerHeight());}else{$('.jspContainer').height(300);}
$('.jspPane').css('top',0);}
pane.css('overflow','auto');if(s.contentWidth){contentWidth=s.contentWidth;}else{contentWidth=pane[0].scrollWidth;}
contentHeight=pane[0].scrollHeight;pane.css('overflow','');percentInViewH=contentWidth/paneWidth;percentInViewV=contentHeight/paneHeight;isScrollableV=percentInViewV>1;isScrollableH=percentInViewH>1;isScrollableH=false;if(!(isScrollableH||isScrollableV)){elem.removeClass('jspScrollable');pane.css({top:0,width:container.width()- originalPaddingTotalWidth});removeMousewheel();removeFocusHandler();removeKeyboardNav();removeClickOnTrack();}else{elem.addClass('jspScrollable');isMaintainingPositon=settings.maintainPosition&&(verticalDragPosition||horizontalDragPosition);if(isMaintainingPositon){lastContentX=contentPositionX();lastContentY=contentPositionY();}
initialiseVerticalScroll();initialiseHorizontalScroll();resizeScrollbars();if(isMaintainingPositon){scrollToX(maintainAtRight?(contentWidth- paneWidth):lastContentX,false);scrollToY(maintainAtBottom?(contentHeight- paneHeight):lastContentY,false);}
initFocusHandler();initMousewheel();initTouch();if(settings.enableKeyboardNavigation){initKeyboardNav();}
if(settings.clickOnTrack){initClickOnTrack();}
observeHash();if(settings.hijackInternalLinks){hijackInternalLinks();}}
if(settings.autoReinitialise&&!reinitialiseInterval){reinitialiseInterval=setInterval(function()
{initialise(settings);},settings.autoReinitialiseDelay);}else if(!settings.autoReinitialise&&reinitialiseInterval){clearInterval(reinitialiseInterval);}
originalScrollTop&&elem.scrollTop(0)&&scrollToY(originalScrollTop,false);originalScrollLeft&&elem.scrollLeft(0)&&scrollToX(originalScrollLeft,false);elem.trigger('jsp-initialised',[isScrollableH||isScrollableV]);}
function initialiseVerticalScroll()
{if(isScrollableV){container.append($('<div class="jspVerticalBar" />').append($('<div class="jspCap jspCapTop" />'),$('<div class="jspTrack" />').append($('<div class="jspDrag" />').append($('<div class="jspDragTop" />'),$('<div class="jspDragBottom" />'))),$('<div class="jspCap jspCapBottom" />')));verticalBar=container.find('>.jspVerticalBar');verticalTrack=verticalBar.find('>.jspTrack');verticalDrag=verticalTrack.find('>.jspDrag');if(settings.showArrows){arrowUp=$('<a class="jspArrow jspArrowUp" />').bind('mousedown.jsp',getArrowScroll(0,-1)).bind('click.jsp',nil);arrowDown=$('<a class="jspArrow jspArrowDown" />').bind('mousedown.jsp',getArrowScroll(0,1)).bind('click.jsp',nil);if(settings.arrowScrollOnHover){arrowUp.bind('mouseover.jsp',getArrowScroll(0,-1,arrowUp));arrowDown.bind('mouseover.jsp',getArrowScroll(0,1,arrowDown));}
appendArrows(verticalTrack,settings.verticalArrowPositions,arrowUp,arrowDown);}
verticalTrackHeight=paneHeight;container.find('>.jspVerticalBar>.jspCap:visible,>.jspVerticalBar>.jspArrow').each(function()
{verticalTrackHeight-=$(this).outerHeight();});verticalDrag.hover(function()
{verticalDrag.addClass('jspHover');},function()
{verticalDrag.removeClass('jspHover');}).bind('mousedown.jsp',function(e)
{$('html').bind('dragstart.jsp selectstart.jsp',nil);verticalDrag.addClass('jspActive');var startY=e.pageY- verticalDrag.position().top;$('html').bind('mousemove.jsp',function(e)
{positionDragY(e.pageY- startY,false);}).bind('mouseup.jsp mouseleave.jsp',cancelDrag);return false;});sizeVerticalScrollbar();}}
function sizeVerticalScrollbar()
{verticalTrack.height(verticalTrackHeight+'px');verticalDragPosition=0;scrollbarWidth=settings.verticalGutter+ verticalTrack.outerWidth();pane.width(paneWidth- scrollbarWidth- originalPaddingTotalWidth);try{if(verticalBar.position().left===0){pane.css('margin-left',scrollbarWidth+'px');}}catch(err){}}
function initialiseHorizontalScroll()
{if(isScrollableH){container.append($('<div class="jspHorizontalBar" />').append($('<div class="jspCap jspCapLeft" />'),$('<div class="jspTrack" />').append($('<div class="jspDrag" />').append($('<div class="jspDragLeft" />'),$('<div class="jspDragRight" />'))),$('<div class="jspCap jspCapRight" />')));horizontalBar=container.find('>.jspHorizontalBar');horizontalTrack=horizontalBar.find('>.jspTrack');horizontalDrag=horizontalTrack.find('>.jspDrag');if(settings.showArrows){arrowLeft=$('<a class="jspArrow jspArrowLeft" />').bind('mousedown.jsp',getArrowScroll(-1,0)).bind('click.jsp',nil);arrowRight=$('<a class="jspArrow jspArrowRight" />').bind('mousedown.jsp',getArrowScroll(1,0)).bind('click.jsp',nil);if(settings.arrowScrollOnHover){arrowLeft.bind('mouseover.jsp',getArrowScroll(-1,0,arrowLeft));arrowRight.bind('mouseover.jsp',getArrowScroll(1,0,arrowRight));}
appendArrows(horizontalTrack,settings.horizontalArrowPositions,arrowLeft,arrowRight);}
horizontalDrag.hover(function()
{horizontalDrag.addClass('jspHover');},function()
{horizontalDrag.removeClass('jspHover');}).bind('mousedown.jsp',function(e)
{$('html').bind('dragstart.jsp selectstart.jsp',nil);horizontalDrag.addClass('jspActive');var startX=e.pageX- horizontalDrag.position().left;$('html').bind('mousemove.jsp',function(e)
{positionDragX(e.pageX- startX,false);}).bind('mouseup.jsp mouseleave.jsp',cancelDrag);return false;});horizontalTrackWidth=container.innerWidth();sizeHorizontalScrollbar();}}
function sizeHorizontalScrollbar()
{container.find('>.jspHorizontalBar>.jspCap:visible,>.jspHorizontalBar>.jspArrow').each(function()
{horizontalTrackWidth-=$(this).outerWidth();});horizontalTrack.width(horizontalTrackWidth+'px');horizontalDragPosition=0;}
function resizeScrollbars()
{if(isScrollableH&&isScrollableV){var horizontalTrackHeight=horizontalTrack.outerHeight(),verticalTrackWidth=verticalTrack.outerWidth();verticalTrackHeight-=horizontalTrackHeight;$(horizontalBar).find('>.jspCap:visible,>.jspArrow').each(function()
{horizontalTrackWidth+=$(this).outerWidth();});horizontalTrackWidth-=verticalTrackWidth;paneHeight-=verticalTrackWidth;paneWidth-=horizontalTrackHeight;horizontalTrack.parent().append($('<div class="jspCorner" />').css('width',horizontalTrackHeight+'px'));sizeVerticalScrollbar();sizeHorizontalScrollbar();}
if(isScrollableH){pane.width((container.outerWidth()- originalPaddingTotalWidth)+'px');}
contentHeight=pane.outerHeight();percentInViewV=contentHeight/paneHeight;if(isScrollableH){horizontalDragWidth=Math.ceil(1/percentInViewH*horizontalTrackWidth);if(horizontalDragWidth>settings.horizontalDragMaxWidth){horizontalDragWidth=settings.horizontalDragMaxWidth;}else if(horizontalDragWidth<settings.horizontalDragMinWidth){horizontalDragWidth=settings.horizontalDragMinWidth;}
horizontalDrag.width(horizontalDragWidth+'px');dragMaxX=horizontalTrackWidth- horizontalDragWidth;_positionDragX(horizontalDragPosition);}
if(isScrollableV){verticalDragHeight=Math.ceil(1/percentInViewV*verticalTrackHeight);if(verticalDragHeight>settings.verticalDragMaxHeight){verticalDragHeight=settings.verticalDragMaxHeight;}else if(verticalDragHeight<settings.verticalDragMinHeight){verticalDragHeight=settings.verticalDragMinHeight;}
verticalDrag.height(verticalDragHeight+'px');dragMaxY=verticalTrackHeight- verticalDragHeight;_positionDragY(verticalDragPosition);}}
function appendArrows(ele,p,a1,a2)
{var p1="before",p2="after",aTemp;if(p=="os"){p=/Mac/.test(navigator.platform)?"after":"split";}
if(p==p1){p2=p;}else if(p==p2){p1=p;aTemp=a1;a1=a2;a2=aTemp;}
ele[p1](a1)[p2](a2);}
function getArrowScroll(dirX,dirY,ele)
{return function()
{arrowScroll(dirX,dirY,this,ele);this.blur();return false;};}
function arrowScroll(dirX,dirY,arrow,ele)
{arrow=$(arrow).addClass('jspActive');var eve,scrollTimeout,isFirst=true,doScroll=function()
{if(dirX!==0){jsp.scrollByX(dirX*settings.arrowButtonSpeed);}
if(dirY!==0){jsp.scrollByY(dirY*settings.arrowButtonSpeed);}
scrollTimeout=setTimeout(doScroll,isFirst?settings.initialDelay:settings.arrowRepeatFreq);isFirst=false;};doScroll();eve=ele?'mouseout.jsp':'mouseup.jsp';ele=ele||$('html');ele.bind(eve,function()
{arrow.removeClass('jspActive');scrollTimeout&&clearTimeout(scrollTimeout);scrollTimeout=null;ele.unbind(eve);});}
function initClickOnTrack()
{removeClickOnTrack();if(isScrollableV){verticalTrack.bind('mousedown.jsp',function(e)
{if(e.originalTarget===undefined||e.originalTarget==e.currentTarget){var clickedTrack=$(this),offset=clickedTrack.offset(),direction=e.pageY- offset.top- verticalDragPosition,scrollTimeout,isFirst=true,doScroll=function()
{var offset=clickedTrack.offset(),pos=e.pageY- offset.top- verticalDragHeight/2,contentDragY=paneHeight*settings.scrollPagePercent,dragY=dragMaxY*contentDragY/(contentHeight- paneHeight);if(direction<0){if(verticalDragPosition- dragY>pos){jsp.scrollByY(-contentDragY);}else{positionDragY(pos);}}else if(direction>0){if(verticalDragPosition+ dragY<pos){jsp.scrollByY(contentDragY);}else{positionDragY(pos);}}else{cancelClick();return;}
scrollTimeout=setTimeout(doScroll,isFirst?settings.initialDelay:settings.trackClickRepeatFreq);isFirst=false;},cancelClick=function()
{scrollTimeout&&clearTimeout(scrollTimeout);scrollTimeout=null;$(document).unbind('mouseup.jsp',cancelClick);};doScroll();$(document).bind('mouseup.jsp',cancelClick);return false;}});}
if(isScrollableH){horizontalTrack.bind('mousedown.jsp',function(e)
{if(e.originalTarget===undefined||e.originalTarget==e.currentTarget){var clickedTrack=$(this),offset=clickedTrack.offset(),direction=e.pageX- offset.left- horizontalDragPosition,scrollTimeout,isFirst=true,doScroll=function()
{var offset=clickedTrack.offset(),pos=e.pageX- offset.left- horizontalDragWidth/2,contentDragX=paneWidth*settings.scrollPagePercent,dragX=dragMaxX*contentDragX/(contentWidth- paneWidth);if(direction<0){if(horizontalDragPosition- dragX>pos){jsp.scrollByX(-contentDragX);}else{positionDragX(pos);}}else if(direction>0){if(horizontalDragPosition+ dragX<pos){jsp.scrollByX(contentDragX);}else{positionDragX(pos);}}else{cancelClick();return;}
scrollTimeout=setTimeout(doScroll,isFirst?settings.initialDelay:settings.trackClickRepeatFreq);isFirst=false;},cancelClick=function()
{scrollTimeout&&clearTimeout(scrollTimeout);scrollTimeout=null;$(document).unbind('mouseup.jsp',cancelClick);};doScroll();$(document).bind('mouseup.jsp',cancelClick);return false;}});}}
function removeClickOnTrack()
{if(horizontalTrack){horizontalTrack.unbind('mousedown.jsp');}
if(verticalTrack){verticalTrack.unbind('mousedown.jsp');}}
function cancelDrag()
{$('html').unbind('dragstart.jsp selectstart.jsp mousemove.jsp mouseup.jsp mouseleave.jsp');if(verticalDrag){verticalDrag.removeClass('jspActive');}
if(horizontalDrag){horizontalDrag.removeClass('jspActive');}}
function positionDragY(destY,animate)
{if(!isScrollableV){return;}
if(destY<0){destY=0;}else if(destY>dragMaxY){destY=dragMaxY;}
if(animate===undefined){animate=settings.animateScroll;}
if(animate){jsp.animate(verticalDrag,'top',destY,_positionDragY);}else{verticalDrag.css('top',destY);_positionDragY(destY);}}
function _positionDragY(destY)
{if(destY===undefined){destY=verticalDrag.position().top;}
container.scrollTop(0);verticalDragPosition=destY;var isAtTop=verticalDragPosition===0,isAtBottom=verticalDragPosition==dragMaxY,percentScrolled=destY/dragMaxY,destTop=-percentScrolled*(contentHeight- paneHeight);if(wasAtTop!=isAtTop||wasAtBottom!=isAtBottom){wasAtTop=isAtTop;wasAtBottom=isAtBottom;elem.trigger('jsp-arrow-change',[wasAtTop,wasAtBottom,wasAtLeft,wasAtRight]);}
updateVerticalArrows(isAtTop,isAtBottom);pane.css('top',destTop);elem.trigger('jsp-scroll-y',[-destTop,isAtTop,isAtBottom]).trigger('scroll');}
function positionDragX(destX,animate)
{if(!isScrollableH){return;}
if(destX<0){destX=0;}else if(destX>dragMaxX){destX=dragMaxX;}
if(animate===undefined){animate=settings.animateScroll;}
if(animate){jsp.animate(horizontalDrag,'left',destX,_positionDragX);}else{horizontalDrag.css('left',destX);_positionDragX(destX);}}
function _positionDragX(destX)
{if(destX===undefined){destX=horizontalDrag.position().left;}
container.scrollTop(0);horizontalDragPosition=destX;var isAtLeft=horizontalDragPosition===0,isAtRight=horizontalDragPosition==dragMaxX,percentScrolled=destX/dragMaxX,destLeft=-percentScrolled*(contentWidth- paneWidth);if(wasAtLeft!=isAtLeft||wasAtRight!=isAtRight){wasAtLeft=isAtLeft;wasAtRight=isAtRight;elem.trigger('jsp-arrow-change',[wasAtTop,wasAtBottom,wasAtLeft,wasAtRight]);}
updateHorizontalArrows(isAtLeft,isAtRight);pane.css('left',destLeft);elem.trigger('jsp-scroll-x',[-destLeft,isAtLeft,isAtRight]).trigger('scroll');}
function updateVerticalArrows(isAtTop,isAtBottom)
{if(settings.showArrows){arrowUp[isAtTop?'addClass':'removeClass']('jspDisabled');arrowDown[isAtBottom?'addClass':'removeClass']('jspDisabled');}}
function updateHorizontalArrows(isAtLeft,isAtRight)
{if(settings.showArrows){arrowLeft[isAtLeft?'addClass':'removeClass']('jspDisabled');arrowRight[isAtRight?'addClass':'removeClass']('jspDisabled');}}
function scrollToY(destY,animate)
{var percentScrolled=destY/(contentHeight- paneHeight);positionDragY(percentScrolled*dragMaxY,animate);}
function scrollToX(destX,animate)
{var percentScrolled=destX/(contentWidth- paneWidth);positionDragX(percentScrolled*dragMaxX,animate);}
function scrollToElement(ele,stickToTop,animate)
{var e,eleHeight,eleWidth,eleTop=0,eleLeft=0,viewportTop,viewportLeft,maxVisibleEleTop,maxVisibleEleLeft,destY,destX;try{e=$(ele);}catch(err){return;}
eleHeight=e.outerHeight();eleWidth=e.outerWidth();container.scrollTop(0);container.scrollLeft(0);while(!e.is('.jspPane')){eleTop+=e.position().top;eleLeft+=e.position().left;e=e.offsetParent();if(/^body|html$/i.test(e[0].nodeName)){return;}}
viewportTop=contentPositionY();maxVisibleEleTop=viewportTop+ paneHeight;if(eleTop<viewportTop||stickToTop){destY=eleTop- settings.verticalGutter;}else if(eleTop+ eleHeight>maxVisibleEleTop){destY=eleTop- paneHeight+ eleHeight+ settings.verticalGutter;}
if(destY){scrollToY(destY,animate);}
viewportLeft=contentPositionX();maxVisibleEleLeft=viewportLeft+ paneWidth;if(eleLeft<viewportLeft||stickToTop){destX=eleLeft- settings.horizontalGutter;}else if(eleLeft+ eleWidth>maxVisibleEleLeft){destX=eleLeft- paneWidth+ eleWidth+ settings.horizontalGutter;}
if(destX){scrollToX(destX,animate);}}
function contentPositionX()
{return-pane.position().left;}
function contentPositionY()
{return-pane.position().top;}
function isCloseToBottom()
{var scrollableHeight=contentHeight- paneHeight;return(scrollableHeight>20)&&(scrollableHeight- contentPositionY()<10);}
function isCloseToRight()
{var scrollableWidth=contentWidth- paneWidth;return(scrollableWidth>20)&&(scrollableWidth- contentPositionX()<10);}
function initMousewheel()
{container.unbind(mwEvent).bind(mwEvent,function(event,delta,deltaX,deltaY){var dX=horizontalDragPosition,dY=verticalDragPosition;jsp.scrollBy(deltaX*settings.mouseWheelSpeed,-deltaY*settings.mouseWheelSpeed,false);return dX==horizontalDragPosition&&dY==verticalDragPosition;});}
function removeMousewheel()
{container.unbind(mwEvent);}
function nil()
{return false;}
function initFocusHandler()
{pane.find(':input,a').unbind('focus.jsp').bind('focus.jsp',function(e)
{scrollToElement(e.target,false);});}
function removeFocusHandler()
{pane.find(':input,a').unbind('focus.jsp');}
function initKeyboardNav()
{var keyDown,elementHasScrolled,validParents=[];isScrollableH&&validParents.push(horizontalBar[0]);isScrollableV&&validParents.push(verticalBar[0]);pane.focus(function()
{elem.focus();});elem.attr('tabindex',0).unbind('keydown.jsp keypress.jsp').bind('keydown.jsp',function(e)
{if(e.target!==this&&!(validParents.length&&$(e.target).closest(validParents).length)){return;}
var dX=horizontalDragPosition,dY=verticalDragPosition;switch(e.keyCode){case 40:case 38:case 34:case 32:case 33:case 39:case 37:keyDown=e.keyCode;keyDownHandler();break;case 35:scrollToY(contentHeight- paneHeight);keyDown=null;break;case 36:scrollToY(0);keyDown=null;break;}
elementHasScrolled=e.keyCode==keyDown&&dX!=horizontalDragPosition||dY!=verticalDragPosition;return!elementHasScrolled;}).bind('keypress.jsp',function(e)
{if(e.keyCode==keyDown){keyDownHandler();}
return!elementHasScrolled;});if(settings.hideFocus){elem.css('outline','none');if('hideFocus'in container[0]){elem.attr('hideFocus',true);}}else{elem.css('outline','');if('hideFocus'in container[0]){elem.attr('hideFocus',false);}}
function keyDownHandler()
{var dX=horizontalDragPosition,dY=verticalDragPosition;switch(keyDown){case 40:jsp.scrollByY(settings.keyboardSpeed,false);break;case 38:jsp.scrollByY(-settings.keyboardSpeed,false);break;case 34:case 32:jsp.scrollByY(paneHeight*settings.scrollPagePercent,false);break;case 33:jsp.scrollByY(-paneHeight*settings.scrollPagePercent,false);break;case 39:jsp.scrollByX(settings.keyboardSpeed,false);break;case 37:jsp.scrollByX(-settings.keyboardSpeed,false);break;}
elementHasScrolled=dX!=horizontalDragPosition||dY!=verticalDragPosition;return elementHasScrolled;}}
function removeKeyboardNav()
{elem.attr('tabindex','-1').removeAttr('tabindex').unbind('keydown.jsp keypress.jsp');}
function observeHash()
{if(location.hash&&location.hash.length>1){var e,retryInt,hash=escape(location.hash.substr(1));try{e=$('#'+ hash+', a[name="'+ hash+'"]');}catch(err){return;}
if(e.length&&pane.find(hash)){if(container.scrollTop()===0){retryInt=setInterval(function()
{if(container.scrollTop()>0){scrollToElement(e,true);$(document).scrollTop(container.position().top);clearInterval(retryInt);}},50);}else{scrollToElement(e,true);$(document).scrollTop(container.position().top);}}}}
function hijackInternalLinks()
{if($(document.body).data('jspHijack')){return;}
$(document.body).data('jspHijack',true);$(document.body).delegate('a[href*=#]','click',function(event){var href=this.href.substr(0,this.href.indexOf('#')),locationHref=location.href,hash,element,container,jsp,scrollTop,elementTop;if(location.href.indexOf('#')!==-1){locationHref=location.href.substr(0,location.href.indexOf('#'));}
if(href!==locationHref){return;}
hash=escape(this.href.substr(this.href.indexOf('#')+ 1));element;try{element=$('#'+ hash+', a[name="'+ hash+'"]');}catch(e){return;}
if(!element.length){return;}
container=element.closest('.jspScrollable');jsp=container.data('jsp');jsp.scrollToElement(element,true);if(container[0].scrollIntoView){scrollTop=$(window).scrollTop();elementTop=element.offset().top;if(elementTop<scrollTop||elementTop>scrollTop+ $(window).height()){container[0].scrollIntoView();}}
event.preventDefault();});}
function initTouch()
{var startX,startY,touchStartX,touchStartY,moved,moving=false;container.unbind('touchstart.jsp touchmove.jsp touchend.jsp click.jsp-touchclick').bind('touchstart.jsp',function(e)
{var touch=e.originalEvent.touches[0];startX=contentPositionX();startY=contentPositionY();touchStartX=touch.pageX;touchStartY=touch.pageY;moved=false;moving=true;}).bind('touchmove.jsp',function(ev)
{if(!moving){return;}
var touchPos=ev.originalEvent.touches[0],dX=horizontalDragPosition,dY=verticalDragPosition;jsp.scrollTo(startX+ touchStartX- touchPos.pageX,startY+ touchStartY- touchPos.pageY);moved=moved||Math.abs(touchStartX- touchPos.pageX)>5||Math.abs(touchStartY- touchPos.pageY)>5;return dX==horizontalDragPosition&&dY==verticalDragPosition;}).bind('touchend.jsp',function(e)
{moving=false;}).bind('click.jsp-touchclick',function(e)
{if(moved){moved=false;return false;}});}
function destroy(){var currentY=contentPositionY(),currentX=contentPositionX();elem.removeClass('jspScrollable').unbind('.jsp');elem.replaceWith(originalElement.append(pane.children()));originalElement.scrollTop(currentY);originalElement.scrollLeft(currentX);if(reinitialiseInterval){clearInterval(reinitialiseInterval);}}
$.extend(jsp,{reinitialise:function(s)
{s=$.extend({},settings,s);initialise(s);},scrollToElement:function(ele,stickToTop,animate)
{scrollToElement(ele,stickToTop,animate);},scrollTo:function(destX,destY,animate)
{scrollToX(destX,animate);scrollToY(destY,animate);},scrollToX:function(destX,animate)
{scrollToX(destX,animate);},scrollToY:function(destY,animate)
{scrollToY(destY,animate);},scrollToPercentX:function(destPercentX,animate)
{scrollToX(destPercentX*(contentWidth- paneWidth),animate);},scrollToPercentY:function(destPercentY,animate)
{scrollToY(destPercentY*(contentHeight- paneHeight),animate);},scrollBy:function(deltaX,deltaY,animate)
{jsp.scrollByX(deltaX,animate);jsp.scrollByY(deltaY,animate);},scrollByX:function(deltaX,animate)
{var destX=contentPositionX()+ Math[deltaX<0?'floor':'ceil'](deltaX),percentScrolled=destX/(contentWidth- paneWidth);positionDragX(percentScrolled*dragMaxX,animate);},scrollByY:function(deltaY,animate)
{var destY=contentPositionY()+ Math[deltaY<0?'floor':'ceil'](deltaY),percentScrolled=destY/(contentHeight- paneHeight);positionDragY(percentScrolled*dragMaxY,animate);},positionDragX:function(x,animate)
{positionDragX(x,animate);},positionDragY:function(y,animate)
{positionDragY(y,animate);},animate:function(ele,prop,value,stepCallback)
{var params={};params[prop]=value;ele.animate(params,{'duration':settings.animateDuration,'easing':settings.animateEase,'queue':false,'step':stepCallback});},getContentPositionX:function()
{return contentPositionX();},getContentPositionY:function()
{return contentPositionY();},getContentWidth:function()
{return contentWidth;},getContentHeight:function()
{return contentHeight;},getPercentScrolledX:function()
{return contentPositionX()/ (contentWidth - paneWidth);
},getPercentScrolledY:function()
{return contentPositionY()/ (contentHeight - paneHeight);
},getIsScrollableH:function()
{return isScrollableH;},getIsScrollableV:function()
{return isScrollableV;},getContentPane:function()
{return pane;},scrollToBottom:function(animate)
{positionDragY(dragMaxY,animate);},hijackInternalLinks:$.noop,destroy:function()
{destroy();}});initialise(s);}
settings=$.extend({},$.fn.jScrollPane.defaults,settings);$.each(['mouseWheelSpeed','arrowButtonSpeed','trackClickSpeed','keyboardSpeed'],function(){settings[this]=settings[this]||settings.speed;});return this.each(function()
{var elem=$(this),jspApi=elem.data('jsp');if(jspApi){jspApi.reinitialise(settings);}else{$("script",elem).filter('[type="text/javascript"],:not([type])').remove();jspApi=new JScrollPane(elem,settings);elem.data('jsp',jspApi);}});};$.fn.jScrollPane.defaults={showArrows:false,maintainPosition:true,stickToBottom:false,stickToRight:false,clickOnTrack:true,autoReinitialise:false,autoReinitialiseDelay:500,verticalDragMinHeight:0,verticalDragMaxHeight:99999,horizontalDragMinWidth:0,horizontalDragMaxWidth:99999,contentWidth:undefined,animateScroll:false,animateDuration:300,animateEase:'linear',hijackInternalLinks:false,verticalGutter:4,horizontalGutter:4,mouseWheelSpeed:0,arrowButtonSpeed:0,arrowRepeatFreq:50,arrowScrollOnHover:false,trackClickSpeed:0,trackClickRepeatFreq:70,verticalArrowPositions:'split',horizontalArrowPositions:'split',enableKeyboardNavigation:true,hideFocus:false,keyboardSpeed:0,initialDelay:300,speed:30,scrollPagePercent:.8};})(jQuery,this);;(function($){var undefined;window.SelectBoxManager=function(options){var sbs=[],self=this;$sj(document).click(function(e){if($sj(e.target).parents(".customSelect").get(0)==null){self.close();}});this.add=function(sb){sbs.push(sb);};this.close=function(){$sj(sbs).each(function(){this.close();});};};var sb_manager=new SelectBoxManager();window.SelectBox=function(options){var self=this,cfg=$sj.extend(true,{manager:sb_manager,customScrollbar:true,zIndex:100,changeCallback:function(val,self){},truncate:function(str){return str;},scrollOptions:{}},options);var $customSelect,$selectedValue,$selectValueWrap,$selectList,$dl,$options,_useDefaultBehavior=false,_isOpen=false,_isEnabled=true,_isFocused=false,_selectedValue="";function init(){_useDefaultBehavior=(navigator.userAgent.match(/iPhone/i))||(navigator.userAgent.match(/iPad/i))?true:false;var selectId="";if(typeof cfg.selectbox.attr("id")!=="undefined"){selectId='id="select-'+cfg.selectbox.attr("id")+'"';}
cfg.selectbox.wrap('<div class="customSelect" '+selectId+' />');$customSelect=cfg.selectbox.parents(".customSelect");$options=cfg.selectbox.find("option");var selectListHTML=['<div class="selectList"><div class="selectListOuterWrap"><div class="selectListInnerWrap"><div class="selectListTop"></div><dl>'];selectListHTML.push(_renderOptions());selectListHTML.push('</dl><div class="selectListBottom"></div></div></div></div>');$customSelect.append('<div class="selectValueWrap"><div class="selectedValue">'+_selectedValue+'</div> </div>'+ selectListHTML.join(""));$dl=$customSelect.find("dl");$selectedValue=$customSelect.find(".selectedValue");$selectValueWrap=$customSelect.find(".selectValueWrap");$selectList=$customSelect.find(".selectList");$customSelect.width(cfg.width);$dl.width(cfg.width- 2);_bindEvents();sb_manager.add(self);}
function _bindEvents(){$selectValueWrap.click(function(){if(_isOpen){cfg.selectbox.focus();self.close();}else if(_isEnabled){if(_useDefaultBehavior){cfg.selectbox.focus();}else{self.open();}}});$dl.click(function(e){var $target=$sj(e.target);if($target.is("dd")||$target.parents("dd")){if(e.target.tagName.toLowerCase()!="dd"){$target=$target.parents("dd");}
if($target.get(0)){self.jumpToIndex($target.get(0).className.split(" ")[0].split("-")[1]);self.close();if(!_useDefaultBehavior){cfg.selectbox.focus();}}}});cfg.selectbox.focus(function(e){_isFocused=true;$customSelect.addClass("focused");}).blur(function(e){_isFocused=false;$customSelect.removeClass("focused");});$customSelect.click(function(){if(!$customSelect.hasClass('no-reset')){$('dl dd:first',this).hide();}});if(_useDefaultBehavior){cfg.selectbox.change(function(e){_updateValue($sj(this).find("option:selected").html());});}
cfg.selectbox.keyup(function(e){self.close();$options.each(function(i,itm){if(itm.selected){self.jumpToIndex(i);return false;}});});_bindHover();}
function _bindHover(){var $dds=$sj(".customSelect dd");$dds.off("mouseover");$dds.off("mouseout");$dds.on("mouseover",function(e){var $target=$sj(e.target);if(e.target.tagName.toLowerCase()!="dd"){$target=$target.parents("dd");}
$target.addClass("hovered");});$dds.on("mouseout",function(e){var $target=$sj(e.target);if(e.target.tagName.toLowerCase()!="dd"){$target=$target.parents("dd");}
$target.removeClass("hovered");});}
function _updateValue(val){if($selectedValue.html()!=val){$selectedValue.html(_truncate(val));cfg.changeCallback(cfg.selectbox.val(),cfg.selectbox);}}
function _renderOptions(){var optionHTML=[];$options.each(function(i,itm){var $this=$sj(this);var optgroup=$this.parents('optgroup');if(optgroup.length>0&&$this.prev().length===0){optionHTML.push('<dt>'+optgroup.attr('label')+'</dt>');}
var iconMarkup="";if(itm.className!=""){$(itm.className.split(" ")).each(function(){iconMarkup+='<span class="'+ this+'"></span>';});}
if(itm.selected){_selectedValue=iconMarkup+ _truncate($sj(itm).html());optionHTML.push('<dd class="itm-'+i+' selected">'+ iconMarkup+ itm.innerHTML+'</dd>');}else{optionHTML.push('<dd class="itm-'+i+'">'+ iconMarkup+ itm.innerHTML+'</dd>');}});if($selectedValue&&$selectedValue.get(0)!=null){$selectedValue.html(_selectedValue);}
return optionHTML.join("");}
function _setupScrollbar(){$dl.css("height","auto");if(cfg.height&&$dl.height()>cfg.height){$dl.css("height",cfg.height);$dl.removeClass('jspScrollable');if(cfg.customScrollbar){if(!self.scrollpane){self.scrollpane=$dl.jScrollPane($.extend({contentWidth:200},cfg.scrollOptions));}else{self.scrollpane.data('jsp').reinitialise();}}else{$dl.addClass("defaultScrollbar");}}else{$dl.css({overflow:"hidden"});if(self.scrollpane){self.scrollpane.data('jsp').reinitialise();}}}
function _truncate(str){var arr=str.split("</span>");var valToTrunc=arr[arr.length- 1];arr[arr.length- 1]="";var spans=arr.join("</SPAN>");return spans+'<span><span>'+cfg.truncate(valToTrunc)+'</span></span><a href="#" class="reset"></a><i class="icon icon-angle-down"></i>';}
this.sync=function(){$options=cfg.selectbox.find("option");if(self.scrollpane){var con=self.scrollpane.data('jsp').getContentPane();}else{var con=$dl;}
con.html(_renderOptions());_bindHover();_setupScrollbar();};this.disable=function(){_isEnabled=false;$customSelect.addClass("disabled");cfg.selectbox.attr("disabled","disabled");};this.enable=function(){_isEnabled=true;$customSelect.removeClass("disabled");cfg.selectbox.removeAttr("disabled");};this.close=function(){$customSelect.removeClass("select-open");$customSelect.css({"z-index":cfg.zIndex});_isOpen=false;};this.open=function(){_setupScrollbar();if(cfg.manager){cfg.manager.close();}
$customSelect.addClass("select-open");if(self.scrollpane){}
$customSelect.css({"z-index":cfg.zIndex+ 1});_isOpen=true;};this.jumpToIndex=function(index){if(!$customSelect.hasClass('no-reset')){if(index==0){$customSelect.find(".selectedValue").removeClass('visible');}else{$customSelect.find(".selectedValue").addClass('visible');}}
cfg.selectbox.get(0).selectedIndex=index;$customSelect.find(".selected").removeClass("selected");$customSelect.find(".itm-"+ index).addClass("selected");_updateValue($customSelect.find(".itm-"+ index).html());};this.jumpToOption=function(value){var index=-1;$options.each(function(i){if($(this).val()==value){index=i;return false;}});if(index!=-1){self.jumpToIndex(index);}
return index;};this.jumpToValue=function(value){var index=-1;$options.each(function(i){if(this.innerHTML==value){index=i;return false;}});if(index!=-1){self.jumpToIndex(index);}
return index;};init();};})(jQuery);;(function($){window.RankingManager={};window.RankingManager.rank={region:'',country:'',faculty:'',stars:'false',sorting:'rank',search:''};window.RankingManager.selectboxes={};window.RankingManager.all_countries=[];window.RankingManager.country_copy='';window.RankingManager.country_lookup={};window.RankingManager._sortindex='';window.RankingManager.offset=0;window.RankingManager._limit=50;window.RankingManager.data=[];window.RankingManager.limit=window.RankingManager._limit;window.RankingManager.template={item:'',empty:''};window.RankingManager.match=[];window.RankingManager.match_setup={};window.RankingManager.mapping={size:{XL:'> 30,000',L:'< 30,000',M:'< 12,000',S:'< 5,000'},focus:{FC:'Comprehensive+',CO:'Comprehensive',FO:'Focused',SP:'Specialist'},focus_pos:{FC:-268,CO:-201,FO:-134,SP:-67},age:{5:'> 100 years',4:'< 100 years',3:'< 50 years',2:'< 25 years',1:'< 10 years'},research:{VH:'Very High',HI:'High',MD:'Medium',LO:'Low'}};window.RankingManager.refresh=true;window.RankingManager.timer={};$sj(document).ready(function(){initFacultyFilter(Drupal.settings.qs_custom_rankings.criteria_definition);initLocationFilter(Drupal.settings.qs_custom_rankings.locations);if(!Array.prototype.indexOf){Array.prototype.indexOf=function(elt){var len=this.length>>>0;var from=Number(arguments[1])||0;from=(from<0)?Math.ceil(from):Math.floor(from);if(from<0)
from+=len;for(;from<len;from++)
{if(from in this&&this[from]===elt)
return from;}
return-1;};}
$sj("#ranking-wp select").each(function(){var sb=new SelectBox({selectbox:$(this),height:300,autoReinitialise:true,changeCallback:function(val,scope){switch(scope.attr('id')){case'filter-region':$('#search-uni').val('');window.RankingManager.rank.search='';switchCountry(Drupal.settings.qs_custom_rankings.locations,val);window.RankingManager.rank.region=val;track('filter','select','region',parseInt(val));break;case'filter-country':$('#search-uni').val('');window.RankingManager.rank.search='';window.RankingManager.rank.country=val;track('filter','select','country',parseInt(val));break;case'filter-faculty':if(checkFacultyUse(val)){$('#search-uni').val('');window.RankingManager.rank.search='';window.RankingManager.rank.faculty=val;updateFilterFaculty(val);track('filter','select','faculty',parseInt(val));}else{window.RankingManager.selectboxes['filter-faculty'].jumpToIndex(0);}
break;case'order-values':window.RankingManager.rank.sorting=val;track('sort','select','categories',parseInt(val));break;default:break;}
updateTable();}});$(this).parent().addClass($(this).attr('class'));window.RankingManager.selectboxes[$(this).attr('id')]=sb;});$('#select-order-values').addClass('no-reset').mousedown(function(){$('#content .dropdown-tooltip').fadeOut(1000);return false;});updateFilterFaculty('');window.RankingManager.template.item=$('#ranking-table tbody tr:eq(0)').clone();window.RankingManager.template.empty=$('#ranking-table tbody tr:eq(1)').clone();$('#content #check-stars').click(function(){$(this).next().toggleClass('active');window.RankingManager.rank.stars=$(this).is(":checked")?true:false;track('filter','select','qsstars',parseInt(window.RankingManager.rank.stars));updateTable();});$('#qs-stars-help').hover(function(){showTooltip($(this),'QS Stars is distinct from rankings. So far, 150 universities in over 35 countries have been rated in up to 12 categories. Click the QS Stars for detailed results.',0,200);},function(){hideTooltip();});$('#content .get-more').click(function(){track('table','rankings','more');populateTable();return false;});$('#content #reset-region').click(function(){window.RankingManager.selectboxes['filter-region'].jumpToIndex(0);window.RankingManager.selectboxes['filter-country'].jumpToIndex(0);return false;});$('#content #reset-faculty').click(function(){window.RankingManager.selectboxes['filter-faculty'].jumpToIndex(0);return false;});$('#search-uni').keyup(function(e){window.RankingManager.rank.search=$(this).val().toLowerCase();if(window.RankingManager.rank.search.length>=2){$('#content thead .uni .blue-bg a.search-reset').show();$('#content thead .uni .blue-bg a.search-enter').hide();updateTable();}else if(window.RankingManager.rank.search.length==0){window.RankingManager.limit=window.RankingManager._limit;$('#content thead .uni .blue-bg a.search-reset').hide();$('#content thead .uni .blue-bg a.search-enter').show();updateTable();}else{$('#content thead .uni .blue-bg a.search-reset').show();$('#content thead .uni .blue-bg a.search-enter').hide();$('#ranking-table tbody').empty();}
if(e.which==13){track('search','enter',window.RankingManager.rank.search);window.RankingManager.limit=10000;}else{window.RankingManager.limit=window.RankingManager._limit;}}).focus(function(){if(window.RankingManager.rank.search.length>0){window.RankingManager.limit=window.RankingManager._limit;$(this).val('');window.RankingManager.rank.search='';updateTable();}
$('#content thead .uni .blue-bg a.search-reset').hide();$('#content thead .uni .blue-bg a.search-enter').show();}).blur(function(){setTimeout(function(){if($('#search-uni').val()==''){$('#content thead .uni .blue-bg a.search-reset').hide();$('#content thead .uni .blue-bg a.search-enter').show();}else{$('#content thead .uni .blue-bg a.search-reset').show();$('#content thead .uni .blue-bg a.search-enter').hide();}},2000);});$('#content thead .uni .blue-bg a.search-reset').click(function(){window.RankingManager.limit=window.RankingManager._limit;$('#search-uni').val('');$('#content thead .uni .blue-bg a.search-reset').hide();$('#content thead .uni .blue-bg a.search-enter').show();window.RankingManager.rank.search='';updateTable();return false;});$('#content thead .uni .blue-bg a.search-enter').click(function(){if($('#search-uni').val().length>0){window.RankingManager.rank.search=$('#search-uni').val().toLowerCase();window.RankingManager.limit=10000;track('search','enter',window.RankingManager.rank.search);$('#content thead .uni .blue-bg a.search-reset').show();$('#content thead .uni .blue-bg a.search-enter').hide();updateTable();}
return false;});$sj(document).on('click','.customSelect .selectedValue a.reset',function(event){var box=$(this).parent().parent().parent();$('dl dd:first',box).show();event.stopPropagation();window.RankingManager.selectboxes[$('select',box).attr('id')].jumpToIndex(0);window.RankingManager.selectboxes[$('select',box).attr('id')].close();if($('select',box).attr('id')=='filter-region'){window.RankingManager.selectboxes['filter-country'].jumpToIndex(0);}
return false;});$sj(document).on('click','#ranking-table tbody td.uni .l12 a',function(event){track('university','click','pagelink',parseInt($(this).parent().parent().parent().parent().parent().attr('id').split('uni-')[1]));event.stopPropagation();});$sj(document).on('click','#ranking-table tbody td.match input, #ranking-table tbody td.match label',function(event){event.stopPropagation();});$sj(document).on('click','#ranking-table tbody tr',function(event){var item=$(this);if(item.hasClass('item')){track('university','click','pagelink',parseInt(item.attr('id').split('uni-')[1]));var url=$('.uni .l12 a',item).attr('href');window.location=url;}});activateLogin();$.ajax({type:"GET",url:Drupal.settings.qs_custom_rankings.flat_file,dataType:'json',success:function(result){window.RankingManager.data=result;if(document.location.hash){var hash=document.location.hash.split('#')[1];hash=hash.split('+');for(var key in hash){if($.type(hash[key])!='function'){var arr=hash[key].split('=');window.RankingManager.rank[arr[0]]=arr[1];}}
window.RankingManager.rank.sorting=window.RankingManager.rank.sorting==''?'rank':window.RankingManager.rank.sorting;$('#search-uni').val(window.RankingManager.rank.search);if(window.RankingManager.rank.region){if(window.RankingManager.rank.country){window.RankingManager.selectboxes['filter-country'].jumpToOption(window.RankingManager.rank.country);}else{window.RankingManager.selectboxes['filter-region'].jumpToOption(window.RankingManager.rank.region);}}else if(window.RankingManager.rank.country){window.RankingManager.selectboxes['filter-country'].jumpToOption(window.RankingManager.rank.country);}
if(window.RankingManager.rank.faculty){window.RankingManager.selectboxes['filter-faculty'].jumpToOption(window.RankingManager.rank.faculty);}
if(window.RankingManager.rank.sorting!='rank'){window.RankingManager.selectboxes['order-values'].jumpToOption(window.RankingManager.rank.sorting);}
if(window.RankingManager.rank.stars=='true'){$('#content #check-stars').attr('checked','checked');}
if(window.RankingManager.rank.search.length>0){$('#search-uni').val(window.RankingManager.rank.search);$('#content thead .uni .blue-bg a.search-reset').show();$('#content thead .uni .blue-bg a.search-enter').hide();}}
window.RankingManager.rank.stars=window.RankingManager.rank.stars=='false'?false:true;updateTable();$('#content .widget-tooltip').css('top',($('.ranking-wrapper').position().top+303)).fadeIn(1000);$('#content .dropdown-tooltip').css('top',($('.ranking-wrapper').position().top+205)).fadeIn(1000);},error:function(result){}});function track(category,action,label,value){if(value==''||value==undefined||isNaN(value)){ga('send','event',category,action,label);}else{ga('send','event',category,action,label,value);}}
function openComparePage(){if($('#footer .panel-pane.pane-qs-reg-pane').length>0){var action=$('#user-login-form').attr('action').split('?destination');var path=action[0]+'?destination=compare-universities/'+Drupal.settings.qs_custom_rankings.current_release_set+'/'+window.RankingManager.match.join('%2C');$('#qs-custom-qs-reg-login-block #user-login-form').attr('action',path);track('compare','openlogin',window.RankingManager.match.join('%2C'));openLogin();}else{track('compare','click',window.RankingManager.match.join('%2C'));window.location.href="/compare-universities/"+Drupal.settings.qs_custom_rankings.current_release_set+"/"+window.RankingManager.match.join('%2C');}}
function checkFacultyUse(val){if($('#footer .panel-pane.pane-qs-reg-pane').length>0&&val!=''){var action=$('#user-login-form').attr('action');$('#qs-custom-qs-reg-login-block #user-login-form').attr('action',action);track('filter','select','openlogin',parseInt(val));openLogin();return false;}else{return true;}
hideTooltip();}
function activateLogin(){if($('#footer .panel-pane.pane-qs-reg-pane').length>0){$('#footer .panel-pane.pane-qs-reg-pane .icon-remove').click(function(){closeLogin();});$(document).mouseup(function(e){var container=$(".pane-qs-reg-pane");if(!container.is(e.target)&&container.has(e.target).length===0){closeLogin();}});$('#qs-custom-qs-register-cta a, #qs-custom-qs-reg-login-block #edit-submit').addClass('btn yellow-bg')
$('#qs-custom-qs-reg-login-block input[type="text"], #qs-custom-qs-reg-login-block input[type="password"]').addClass('gray-bg');$('#qs-custom-qs-reg-login-block input[type="text"]').focus(function(){$(this).attr('placeholder','');$(this).val('');}).blur(function(){$(this).attr('placeholder','Username');});$('#qs-custom-qs-reg-login-block input[type="password"]').focus(function(){$(this).attr('placeholder','');$(this).val('');}).blur(function(){$(this).attr('placeholder','Password');});$('#footer .panel-pane.pane-qs-reg-pane #qs-custom-qs-reg-login-block a.facebook-action-connect').before('<br /><span>or </span>').html('Log in with Facebook').addClass('blue');$('#select-filter-faculty').mouseover(function(){showTooltip($(this),'This feature is only available to registered users');}).mouseout(function(){hideTooltip();});$('#qs-custom-qs-register-cta a').click(function(){track('login','click','register');});$('#qs-custom-qs-reg-login-block #edit-submit').click(function(){track('login','click','login');});$('#qs-custom-qs-reg-login-block .facebook-action-connect').click(function(){track('login','click','facebook-login');});}}
function openLogin(){pos=($(window).width()- 671)/ 2;$('#footer .panel-pane.pane-qs-reg-pane').css('left',pos);$('#footer #login-overlay').fadeIn(300);$('#footer .panel-pane.pane-qs-reg-pane').fadeIn(300);setTimeout(function(){selectover();},10);}
function closeLogin(){$('#footer #login-overlay').hide();}
function updateTable(){window.RankingManager.offset=0;document.location.hash='sorting='+window.RankingManager.rank.sorting+'+region='+window.RankingManager.rank.region+'+country='+window.RankingManager.rank.country+'+faculty='+window.RankingManager.rank.faculty+'+stars='+window.RankingManager.rank.stars+'+search='+window.RankingManager.rank.search;if(window.RankingManager.rank.sorting=='rank'&&window.RankingManager.rank.region==''&&window.RankingManager.rank.country==''&&window.RankingManager.rank.faculty==''&&!window.RankingManager.rank.stars){window.RankingManager._sortindex='rank';if(window.RankingManager.rank.search.length==0){window.RankingManager.filtered=window.RankingManager.data;}else{window.RankingManager.filtered=getSearchData();}}else{if(window.RankingManager.rank.search.length==0){window.RankingManager.filtered=getFilteredData();}else{window.RankingManager.filtered=getSearchData();}
if(window.RankingManager.rank.sorting=='rank'){window.RankingManager._sortindex=window.RankingManager.rank.sorting;}else if(window.RankingManager.rank.sorting=='faculty_value'){window.RankingManager._sortindex=window.RankingManager.rank.faculty;window.RankingManager.filtered.sort(compareRank);}else{window.RankingManager._sortindex=window.RankingManager.rank.sorting;var clone=[];$.each(window.RankingManager.filtered,function(){if(this[window.RankingManager._sortindex]&&this[window.RankingManager._sortindex].score&&this[window.RankingManager._sortindex].rank>0){clone.push(this);}});window.RankingManager.filtered=clone;window.RankingManager.filtered.sort(compareRank);}}
$('#ranking-table tbody').empty();$('#uni-widget').fadeOut(500);$('#content .widget-pointer').fadeOut(500);$('#main .pane-dfp-site-wide-2-300-x-250').css({position:'static'});window.RankingManager.match_setup={};for(var item in window.RankingManager.match){window.RankingManager.match_setup[window.RankingManager.match[item]]=true;}
window.RankingManager.match=[];$('#content .get-more').show();populateTable();}
function showTooltip(item,copy,x,minwidth,align){x=x==undefined?0:x;if(align!=undefined){$('#content .main-tooltip .l12').css('text-align',align);}else{$('#content .main-tooltip .l12').css('text-align','left');}
$('#content .main-tooltip').css('display','block');if(minwidth!=undefined){$('#content .main-tooltip').css('min-width',minwidth);}else{$('#content .main-tooltip').css('min-width','auto');}
$('#content .main-tooltip .l12').html(copy);$('#content .main-tooltip').css({top:item.offset().top- $('.pane-qs-custom-rankings-pane').offset().top- $('#content .tooltip').height()- 75,left:item.offset().left+ item.width()/2+x-$('.pane-qs-custom-rankings-pane').offset().left-$('#content .tooltip').width()/2 - 15,display:'block'}).fadeIn(300);}
function hideTooltip(){$('#content .main-tooltip').css('display','none');}
function populateTable(){var index=0;while(index<window.RankingManager.limit){if(window.RankingManager.offset<window.RankingManager.filtered.length){var obj=window.RankingManager.filtered[window.RankingManager.offset];if(obj!=undefined){var rank=window.RankingManager._sortindex=='rank'?obj[window.RankingManager._sortindex]:obj[window.RankingManager._sortindex]['rank'];if(((window.RankingManager._sortindex=='rank'&&obj['rank_display']!='N/A')||(window.RankingManager._sortindex!='rank'&&rank<=502))&&rank>0){var score=window.RankingManager._sortindex=='rank'?obj['score_overall']:obj[window.RankingManager._sortindex]['score'];var display=window.RankingManager._sortindex=='rank'?obj['rank_display']:obj[window.RankingManager._sortindex]['rank_display'];if(display){display=$.trim(display);}else{display=rank;}
var tr=window.RankingManager.template.item.clone();tr.addClass(window.RankingManager.offset%2==1?'even':'odd');tr.attr('id','uni-'+obj.nid)
$('#ranking-table tbody').append(tr.css('display','table-row'));if(rank<=401){display=display.replace('=','');$('td.rank .ranking',tr).html(display).addClass(display.length>2?(display.length>3?'smallest':'smaller'):'');$('td.rank .result',tr).html(parseFloat(score).toFixed(1));$('td.rank .dark-blue-bg',tr).css('width',(score-2)+'%');if(score>=65){$('td.rank .result',tr).css({'left':$('td.rank .dark-blue-bg',tr).width()- $('td.rank .result',tr).width()- 5});}else{if($('td.rank .dark-blue-bg',tr).width()+ 5>=50){$('td.rank .result',tr).css({'left':$('td.rank .dark-blue-bg',tr).width()+ 5});}else{$('td.rank .result',tr).css({'left':50});}}
if(window.RankingManager.offset<10){$('td.rank .dark-blue-bg',tr).css('width','0%').animate({'width':(score-2)+'%'},1000);}}else{$('td.rank .gray-bg',tr).html('<div><span class="ranking smaller blue">'+display+'</span></div>');}
if(obj.logo){$('td.uni .logo',tr).html(obj.logo);}else{$('td.uni .logo',tr).addClass('empty').empty();}
var undergrad=obj.link.indexOf('/undergrad');if(undergrad!==-1){$('td.uni .l12',tr).html(obj.link.replace("/undergrad","#wur"));}
else{$('td.uni .l12',tr).html(obj.link.replace("/postgrad","#wur"));}
if(Drupal.settings.qs_custom_rankings.flag_lookup[obj.country_tid]!=undefined){$('td.country img',tr).attr('alt',window.RankingManager.country_lookup[obj.country_tid]).attr('src','/sites/all/libraries/flags/'+Drupal.settings.qs_custom_rankings.flag_lookup[obj.country_tid]+'.jpg');}
$('#uni-5143 .country img, #uni-9275 .country img').attr('src','/sites/all/libraries/flags/IR.jpg').attr('alt','Iran');$('td.match input',tr).attr('id','check-'+obj.nid);$('td.match label',tr).attr('for','check-'+obj.nid).addClass(window.RankingManager.match_setup[obj.nid]?'active':'');if(window.RankingManager.match_setup[obj.nid]){window.RankingManager.match.push(obj.nid);}
var stars=$('td.rating .gray-bg',tr).empty();for(var i=0;i<parseInt(obj.qs_stars);i++){if(i==5){stars.append('<span class="qsstar plus"></span>');stars.addClass('plus');}else{stars.append('<span class="qsstar"></span>');}}}}
window.RankingManager.offset++;index++;if(window.RankingManager.offset==window.RankingManager.filtered.length||(window.RankingManager._sortindex!='rank'&&rank>=500)){$('#content .get-more').hide();}}else{index=window.RankingManager.limit;if($('#ranking-table tbody tr').length==0){var tr=window.RankingManager.template.empty.clone();if(window.RankingManager.rank.search==''){$('td p',tr).html('No results found. Please adjust your filter and/or sort criteria to see more results.');}else{$('td p',tr).html('No results found. Please adjust your search term(s) to see more results.');}
$('#ranking-table tbody').append(tr.removeClass('hidde'));$('#content .get-more').hide();}}}}
function getSearchData(){var clone=[];$.each(window.RankingManager.data,function(){if(this.title.toLowerCase().indexOf(window.RankingManager.rank.search)>=0){clone.push(this);}});return clone;}
function getFilteredData(){var clone=[],clone1=[];if(window.RankingManager.rank.country!=''){$.each(window.RankingManager.data,function(){if(this.country_tid==window.RankingManager.rank.country){clone.push(this);}});}else if(window.RankingManager.rank.region!=''){$.each(window.RankingManager.data,function(){if(this.region_tid==window.RankingManager.rank.region){clone.push(this);}});}else{clone=window.RankingManager.data.slice(0);}
if(window.RankingManager.rank.faculty!=''){$.each(clone,function(){if(this[window.RankingManager.rank.faculty]){if(this[window.RankingManager.rank.faculty].score>0){clone1.push(this);}}});}else{clone1=clone.slice(0);}
clone=[];if(window.RankingManager.rank.stars){$.each(clone1,function(){if(this.qs_stars){clone.push(this);}});}else{clone=clone1.slice(0);}
clone1=[];return clone;}
function updateFilterFaculty(val){if(val.length==0){$('#select-order-values dd:last').hide();if($('#order-values').val()=='faculty_value'){window.RankingManager.selectboxes['order-values'].jumpToIndex(0);}}else{$('#select-order-values dd:last').show();window.RankingManager.selectboxes['order-values'].jumpToIndex(7);}}
function switchCountry(values,val){var country=$('#filter-country').empty();country.append('<option value="">'+window.RankingManager.country_copy+'</option>');if(val.length>0){var countries=values[val].children;$.each(countries,function(){country.append('<option value="'+this.tid+'">'+this.name+'</option>');});}else{$.each(window.RankingManager.all_countries,function(){country.append('<option value="'+this.tid+'">'+this.name+'</option>');});}
$('#select-filter-country .selectedValue').removeClass('visible');setTimeout(function(){if(window.RankingManager.selectboxes["filter-country"]){window.RankingManager.selectboxes["filter-country"].sync();}},1);}
function initLocationFilter(values){var region=$('#filter-region');var country=$('#filter-country');window.RankingManager.country_copy=$('#filter-country option:first').html();$.each(values,function(){region.append('<option value="'+this.tid+'">'+this.name+'</option>');for(var attrname in this.children){window.RankingManager.all_countries.push(this.children[attrname]);window.RankingManager.country_lookup[this.children[attrname].tid]=this.children[attrname].name;}});window.RankingManager._sortindex='name';window.RankingManager.all_countries.sort(compareString);switchCountry(values,'');}
function initFacultyFilter(values){var filter=$('#filter-faculty');var sorting=$('#order-values');$.each(values,function(){if(this.type=="faculty_areas"){filter.append('<option value="'+this.item_id+'">'+this.full_name+'</option>');}else if(this.type=="survey_indices"){sorting.append('<option value="'+this.item_id+'">'+this.full_name+'</option>');}});sorting.append('<option value="faculty_value">Faculty Value</option>');}
function compareString(a,b){var i=a[window.RankingManager._sortindex],j=b[window.RankingManager._sortindex];if(i<j)
return-1;if(i>j)
return 1;return 0;}
function compare(a,b){var i=parseFloat(a[window.RankingManager._sortindex]),j=parseFloat(b[window.RankingManager._sortindex]);if(i<j)
return-1;if(i>j)
return 1;return 0;}
function compareRank(a,b){var i=parseFloat(a[window.RankingManager._sortindex]['rank']),j=parseFloat(b[window.RankingManager._sortindex]['rank']);if(i<j)
return-1;if(i>j)
return 1;return 0;}
function selectover(){var domain=window.location.hostname;$('select').each(function(){var $this=$(this);if($this.attr('multiple')==undefined&&$this.is(':visible')){$this.selectik({width:200,maxItems:6,customScroll:1,speedAnimation:0,smartPosition:true,minScrollHeight:10},{_generateHtml:function(){this.$collection=this.$cselect.children();var html='';for(var i=0;i<this.$collection.length;i++){var $this=$(this.$collection[i]),claslen=($this[0].value.length>30?'long':'short');html+='<li class="'+($this.attr('disabled')==='disabled'?'disabled':claslen)+'" data-value="'+$this[0].value+'">'+($this.data('selectik')?$this.data('selectik'):$this[0].text)+'</li>';};return html;}});}});}});})(jQuery);(function($){Drupal.behaviors.qs_custom_rankings={attach:function(context,settings){}};})(jQuery);;(function($){Drupal.googleanalytics={};$(document).ready(function(){$(document.body).bind("mousedown keyup touchstart",function(event){$(event.target).closest("a,area").each(function(){if(Drupal.googleanalytics.isInternal(this.href)){if($(this).is('.colorbox')){}
else if(Drupal.settings.googleanalytics.trackDownload&&Drupal.googleanalytics.isDownload(this.href)){ga("send","event","Downloads",Drupal.googleanalytics.getDownloadExtension(this.href).toUpperCase(),Drupal.googleanalytics.getPageUrl(this.href));}
else if(Drupal.googleanalytics.isInternalSpecial(this.href)){ga("send","pageview",{"page":Drupal.googleanalytics.getPageUrl(this.href)});}}
else{if(Drupal.settings.googleanalytics.trackMailto&&$(this).is("a[href^='mailto:'],area[href^='mailto:']")){ga("send","event","Mails","Click",this.href.substring(7));}
else if(Drupal.settings.googleanalytics.trackOutbound&&this.href.match(/^\w+:\/\//i)){if(Drupal.settings.googleanalytics.trackDomainMode!=2||(Drupal.settings.googleanalytics.trackDomainMode==2&&!Drupal.googleanalytics.isCrossDomain(this.hostname,Drupal.settings.googleanalytics.trackCrossDomains))){ga("send","event","Outbound links","Click",this.href);}}}});});if(Drupal.settings.googleanalytics.trackUrlFragments){window.onhashchange=function(){ga('send','pageview',location.pathname+ location.search+ location.hash);}}
$(document).bind("cbox_complete",function(){var href=$.colorbox.element().attr("href");if(href){ga("send","pageview",{"page":Drupal.googleanalytics.getPageUrl(href)});}});});Drupal.googleanalytics.isCrossDomain=function(hostname,crossDomains){if(!crossDomains){return false;}
else{return $.inArray(hostname,crossDomains)>-1?true:false;}};Drupal.googleanalytics.isDownload=function(url){var isDownload=new RegExp("\\.("+ Drupal.settings.googleanalytics.trackDownloadExtensions+")([\?#].*)?$","i");return isDownload.test(url);};Drupal.googleanalytics.isInternal=function(url){var isInternal=new RegExp("^(https?):\/\/"+ window.location.host,"i");return isInternal.test(url);};Drupal.googleanalytics.isInternalSpecial=function(url){var isInternalSpecial=new RegExp("(\/go\/.*)$","i");return isInternalSpecial.test(url);};Drupal.googleanalytics.getPageUrl=function(url){var extractInternalUrl=new RegExp("^(https?):\/\/"+ window.location.host,"i");return url.replace(extractInternalUrl,'');};Drupal.googleanalytics.getDownloadExtension=function(url){var extractDownloadextension=new RegExp("\\.("+ Drupal.settings.googleanalytics.trackDownloadExtensions+")([\?#].*)?$","i");var extension=extractDownloadextension.exec(url);return(extension===null)?'':extension[1];};})(jQuery);;